<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ComeToMeSports - Find Sporting Events Near You</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>🏆 ComeToMeSports</h1>
            <p class="subtitle">Find sporting events near your ZIP code</p>
        </header>

        <main>
            <div class="search-section">
                <form id="searchForm" class="search-form">
                    <div class="input-group">
                        <label for="zipCode">Enter your ZIP code:</label>
                        <input 
                            type="text" 
                            id="zipCode" 
                            name="zipCode" 
                            placeholder="e.g., 90210" 
                            maxlength="5" 
                            required
                        >
                        <button type="submit">Find Events</button>
                    </div>
                </form>
                <div id="errorMessage" class="error-message" style="display: none;"></div>
            </div>

            <div id="loadingMessage" class="loading" style="display: none;">
                <p>🔍 Searching for events...</p>
            </div>

            <div id="resultsSection" class="results-section" style="display: none;">
                <h2>Sporting Events Near You</h2>
                <div id="eventsList" class="events-list"></div>
            </div>

            <div id="noResults" class="no-results" style="display: none;">
                <h2>No Events Found</h2>
                <p>Sorry, no sporting events were found near your ZIP code. Try a different area!</p>
            </div>
        </main>

        <footer>
            <p>ZIP Code data provided by <a href="https://simplemaps.com/data/us-zips">SimpleMaps.com</a></p>
            <p>&copy; 2025 ComeToMeSports. Find your next 🏂🤽‍♂️🤽‍♀️🤾‍♂️🤾‍♀️🏐🏈🎾🏏🏑🏒🏓🏸🎿🏹 game!</p>
        </footer>
    </div>

    <script>
    // API-based event fetching (modified from original)
    async function fetchEvents() {
        const zipCode = document.getElementById('zipCode').value.trim();
        
        // Hide previous results and errors
        hideError();
        hideLoading();
        document.getElementById('resultsSection').style.display = 'none';
        document.getElementById('noResults').style.display = 'none';

        // Validate ZIP code
        if (!zipCode) {
            showError('Please enter a ZIP code.');
            return;
        }

        if (!isValidZipCode(zipCode)) {
            showError('Please enter a valid 5-digit ZIP code.');
            return;
        }

        // Show loading state
        showLoading();

        try {
            const response = await fetch(`https://your-api-id.execute-api.us-east-1.amazonaws.com/prod/events?zip=${zipCode}`);
            const data = await response.json();
            
            hideLoading();
            
            if (data && data.length > 0) {
                displayEvents(data);
            } else {
                document.getElementById('noResults').style.display = 'block';
            }
        } catch (error) {
            hideLoading();
            showError('Error fetching events. Please try again.');
            console.error('Error:', error);
        }
    }

    // Utility functions (similar to app.js)
    function isValidZipCode(zipCode) {
        const zipRegex = /^\d{5}$/;
        return zipRegex.test(zipCode);
    }

    function showError(message) {
        const errorElement = document.getElementById('errorMessage');
        errorElement.textContent = message;
        errorElement.style.display = 'block';
    }

    function hideError() {
        const errorElement = document.getElementById('errorMessage');
        errorElement.style.display = 'none';
    }

    function showLoading() {
        document.getElementById('loadingMessage').style.display = 'block';
        document.getElementById('resultsSection').style.display = 'none';
        document.getElementById('noResults').style.display = 'none';
    }

    function hideLoading() {
        document.getElementById('loadingMessage').style.display = 'none';
    }

    function displayEvents(events) {
        const eventsList = document.getElementById('eventsList');
        const resultsSection = document.getElementById('resultsSection');
        
        eventsList.innerHTML = events.map(event => `
            <div class="event-card">
                <div class="event-title">${event.title || 'Event'}</div>
                <div class="event-sport">${event.sport || 'Sports'}</div>
                <div class="event-details">
                    <strong>Date:</strong> ${event.date || 'TBD'}<br>
                    <strong>Time:</strong> ${event.time || 'TBD'}<br>
                    <strong>Venue:</strong> ${event.venue || 'TBD'}<br>
                    <strong>Address:</strong> ${event.address || 'TBD'}
                </div>
            </div>
        `).join('');
        
        resultsSection.style.display = 'block';
        document.getElementById('noResults').style.display = 'none';
    }

    // Initialize the application
    function init() {
        const searchForm = document.getElementById('searchForm');
        const zipCodeInput = document.getElementById('zipCode');

        // Add form submission handler
        searchForm.addEventListener('submit', function(event) {
            event.preventDefault();
            fetchEvents();
        });

        // Add input validation
        zipCodeInput.addEventListener('input', (e) => {
            // Only allow digits
            e.target.value = e.target.value.replace(/\D/g, '');
            
            // Hide error when user starts typing
            if (e.target.value.length > 0) {
                hideError();
            }
        });

        // Focus on ZIP code input when page loads
        zipCodeInput.focus();
    }

    // Start the application when DOM is loaded
    document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>